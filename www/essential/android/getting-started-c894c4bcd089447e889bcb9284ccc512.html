<!doctype html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="referrer" content="always">

  <meta name="twitter:card" value="summary">
  <meta name="twitter:site" content="@kjk">
  <meta name="twitter:title" content="Getting Started">
  
  <meta name="twitter:description" content="Getting Started">
  <meta name="twitter:creator" content="@kjk">
  <meta name="twitter:image" content="/essential/android/covers/twitter/Android.png">
  
  <meta property="og:title" content="Getting Started">
  <meta property="og:type" content="article" />
  <meta property="og:url" content="/essential/android/getting-started-c894c4bcd089447e889bcb9284ccc512" />
  
  <meta property="og:description" content="Getting Started">
  <meta property="og:image" content="/essential/android/covers/twitter/Android.png">

  <title>RenderScript / Getting Started / Essential Android</title>
  <meta name="description" content="RenderScript / Getting Started / Essential Android">

  <link rel="icon" href="s/favicon-9dfe2f70.ico">

  <link href="s/main-65ff0b86.css" rel="stylesheet">
  <link href="s/bundle-83cf4538.css" rel="stylesheet">

  
  <script src="s/app-android-029fa25e.js" defer></script>
  <script src="s/bundle-fd6a7ad6.js" defer></script>
</head>

<body class="page">
  <script>
  function onLoad() {
    gBookTitle = "Essential Android";

    httpsMaybeRedirect();

    let opts = {
      target: document.getElementById("toc"),
      props: {
        parentIdx: -1,
        level: 0,
      },
    };
    new app.toc(opts);

    opts = {
      target: document.getElementById("search-parent"),
      props: {
        bookTitle: gBookTitle,
      },
    };
    new app.searchInput(opts);

    opts = {
      target: document.getElementById("page-toc"),
    };
    new app.pageToc(opts);

    opts = {
      target: document.getElementById("book-toc"),
    };
    new app.bookToc(opts);
  }
  document.addEventListener('DOMContentLoaded', onLoad);
</script>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
  <symbol id="arrow-expanded" viewbox="0 0 16 16">
    <path fill="%23646465" d="M11 10H5.344L11 4.414V10z" />
  </symbol>

  <symbol id="arrow-not-expanded" viewbox="0 0 16 16">
    <path fill="%23646465" d="M6 4v8l4-4-4-4zm1 2.414L8.586 8 7 9.586V6.414z" />
  </symbol>

  <symbol id="icon-github" viewbox="0 0 496 512">
    <path
      d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" />
  </symbol>

  <symbol id="icon-home" viewbox="0 0 576 512">
    <path
      d="M488 312.7V456c0 13.3-10.7 24-24 24H348c-6.6 0-12-5.4-12-12V356c0-6.6-5.4-12-12-12h-72c-6.6 0-12 5.4-12 12v112c0 6.6-5.4 12-12 12H112c-13.3 0-24-10.7-24-24V312.7c0-3.6 1.6-7 4.4-9.3l188-154.8c4.4-3.6 10.8-3.6 15.3 0l188 154.8c2.7 2.3 4.3 5.7 4.3 9.3zm83.6-60.9L488 182.9V44.4c0-6.6-5.4-12-12-12h-56c-6.6 0-12 5.4-12 12V117l-89.5-73.7c-17.7-14.6-43.3-14.6-61 0L4.4 251.8c-5.1 4.2-5.8 11.8-1.6 16.9l25.5 31c4.2 5.1 11.8 5.8 16.9 1.6l235.2-193.7c4.4-3.6 10.8-3.6 15.3 0l235.2 193.7c5.1 4.2 12.7 3.5 16.9-1.6l25.5-31c4.2-5.2 3.4-12.7-1.7-16.9z" />
  </symbol>

  <symbol id="icon-twitter" viewbox="0 0 512 512">
    <path
      d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" />
  </symbol>

  <symbol id="icon-edit" viewbox="0 0 576 512">
    <path
      d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z" />
  </symbol>

  <symbol id="icon-star" viewbox="0 0 576 512">
    <path
      d="M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z" />
  </symbol>
</svg>
  <header class="page__header">
  <div class="page__header__left">
    <a id="link-home" href="index.html">
      <svg class="icon-home">
        <use xlink:href="#icon-home"></use>
      </svg>
      &nbsp;Essential Android</a>
  </div>
  <div class="page__header__center" id="search-parent">
  </div>
  <div class="page__header__right">
  </div>
</header>

  <div id="toc"></div>

  <div class="content">
    <div class="article">
      

<div style="display: flex; justify-content: space-between">
  <h1 class="title">Getting Started</h1>
  <a class="edit-link" style="font-size: 80%" href="https://notion.so/c894c4bcd089447e889bcb9284ccc512" rel="nofollow"
  target="_blank">suggest change</a>
</div>


      <p>RenderScript is a framework to allow high performance parallel computation on Android. Scripts you write will be executed across all available processors (e.g. CPU, GPU etc) in parallel allowing you to focus on the task you want to achieve instead of how it is scheduled and executed.</p><p>Scripts are written in a C99 based language (C99 being an old version of the C programming language standard). For each Script a Java class is created which allows you to easily interact with RenderScript in your Java code.</p><h1 id="21957bdd-e931-466d-969b-0fd0993d27a8" class="">Setting up your project<a class="header-anchor" href="#21957bdd-e931-466d-969b-0fd0993d27a8" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h1><p>There exist two different ways to access RenderScript in your app, with the Android Framework libraries or the Support Library. Even if you don’t want to target devices before API level 11 you should always use the Support Library implementation because it ensures devices compatibility across many different devices. To use the support library implementation you need to use at least build tools version <code>18.1.0</code>!</p><p>Now lets setup the build.gradle file of your application:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">android {
    compileSdkVersion 24
    buildToolsVersion &#39;24.0.1&#39;

    defaultConfig {
        minSdkVersion 8
        targetSdkVersion 24

        renderscriptTargetApi 18
        renderscriptSupportModeEnabled true
    }
}</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><ul id="0585b753-842b-403e-82c0-6a9c48b858e6" class="bulleted-list"><li><code>renderscriptTargetApi</code>: This should be set to the version earliest API level which provides all RenderScript functionality you require.</li><li><code>renderscriptSupportModeEnabled</code>: This enables the use of the Support Library RenderScript implementation.</li></ul><h1 id="81ffc6d4-a4e6-43d4-a78f-78833a246e77" class="">How RenderScript works<a class="header-anchor" href="#81ffc6d4-a4e6-43d4-a78f-78833a246e77" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h1><p>A typical RenderScript consists of two things: Kernels and Functions. A function is just what it sounds like - it accepts an input, does something with that input and returns an output. A Kernel is where the real power of RenderScript comes from.</p><p>A Kernel is a function which is executed against every element inside an <code>Allocation</code>. An <code>Allocation</code> can be used to pass data like a <code>Bitmap</code> or a <code>byte</code> array to a <code>RenderScript</code> and they are also used to get a result from a Kernel. Kernels can either take one <code>Allocation</code> as input and another as output or they can modify the data inside just one <code>Allocation</code>.</p><p>You can write your one Kernels, but there are also many predefined Kernels which you can use to perform common operations like a Gaussian Image Blur.</p><p>As already mentioned for every RenderScript file a class is generated to interact with it. These classes always start with the prefix <code>ScriptC_</code> followed by the name of the RenderScript file. For example if your RenderScript file is called <code>example</code> then the generated Java class will be called <code>ScriptC_example</code>. All predefined Scripts just start with the prefix <code>Script</code> - for example the Gaussian Image Blur Script is called <code>ScriptIntrinsicBlur</code>.</p><h1 id="718b4f50-2614-40db-bd55-c00d185f27bb" class="">Writing your first RenderScript<a class="header-anchor" href="#718b4f50-2614-40db-bd55-c00d185f27bb" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h1><p>The following example is based on an example on GitHub. It performs basic image manipulation by modifying the saturation of an image. You can find the source code <a href="https://github.com/Wrdlbrnft/RenderScriptSample"><strong>here</strong></a> and check it out if you want to play around with it yourself. Here’s a quick gif of what the result is supposed to look like:</p><img class="img" src="/img/0fa2a7b2d7c7aa14f3551cd0012350c288c2e835.gif"><p>demo picture</p><h2 id="8464cce0-05c7-4733-b4f9-b435662fddbe" class="">RenderScript Boilerplate<a class="header-anchor" href="#8464cce0-05c7-4733-b4f9-b435662fddbe" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>RenderScript files reside in the folder <code>src/main/rs</code> in your project. Each file has the file extension <code>.rs</code> and has to contain two <code>#pragma</code> statements at the top:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">#pragma version(1)
#pragma rs java_package_name(your.package.name)</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><ul id="6bcc2dea-d075-4786-afee-30063211f082" class="bulleted-list"><li><code>#pragma version(1)</code>: This can be used to set the version of RenderScript you are using. Currently there is only version 1.</li><li><code>#pragma rs java_package_name(your.package.name)</code>: This can be used to set the package name of the Java class generated to interact with this particular RenderScript.</li></ul><p>There is another <code>#pragma</code> you should usually set in each of your RenderScript files and it is used to set the floating point precision. You can set the floating point precision to three different levels:</p><ul id="293ef076-f392-45a7-ab75-5fd8ccffad31" class="bulleted-list"><li><code>#pragma rs_fp_full</code>: This is the strictest setting with the highest precision and it is also the default value if don’t specify anything. You should use this if you require high floating point precision.</li><li><code>#pragma rs_fp_relaxed</code>: This is ensures not quite as high floating point precision, but on some architectures it enables a bunch of optimizations which can cause your scripts to run faster.</li><li><code>#pragma rs_fp_imprecise</code>: This ensures even less precision and should be used if floating point precision does not really matter to your script.</li></ul><p>Most scripts can just use <code>#pragma rs_fp_relaxed</code> unless you really need high floating point precision.</p><h2 id="6fc98ef1-930d-4031-a9ae-9b5407065d87" class="">Global Variables<a class="header-anchor" href="#6fc98ef1-930d-4031-a9ae-9b5407065d87" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>Now just like in C code you can define global variables or constants:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">const static float3 gMonoMult = {0.299f, 0.587f, 0.114f};

float saturationLevel = 0.0f;</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>The variable <code>gMonoMult</code> is of type <code>float3</code>. This means it is a vector consisting of 3 float numbers. The other <code>float</code> variable called <code>saturationValue</code> is not constant, therefore you can set it at runtime to a value you like. You can use variables like this in your Kernels or functions and therefore they are another way to give input to or receive output from your RenderScripts. For each not constant variable a getter and setter method will be generated on the associated Java class.</p><h2 id="c1fcf768-77e5-4017-90f9-c8defda78b63" class="">Kernels<a class="header-anchor" href="#c1fcf768-77e5-4017-90f9-c8defda78b63" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>But now lets get started implementing the Kernel. For the purposes of this example I am not going to explain the math used in the Kernel to modify the saturation of the image, but instead will focus on how to implement a Kernel and and how to use it. At the end of this chapter I will quickly explain what the code in this Kernel is actually doing.</p><h2 id="59002645-e581-48a6-96b4-38bfa5c1324a" class="">Kernels in general<a class="header-anchor" href="#59002645-e581-48a6-96b4-38bfa5c1324a" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>Let’s take a look at the source code first:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">uchar4 __attribute__((kernel)) saturation(uchar4 in) {
    float4 f4 = rsUnpackColor8888(in);
    float3 dotVector = dot(f4.rgb, gMonoMult);
    float3 newColor = mix(dotVector, f4.rgb, saturationLevel);
    return rsPackColorTo8888(newColor);
}</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>As you can see it looks like a normal C function with one exception: The <code>__attribute__((kernel))</code> between the return type and method name. This is what tells RenderScript that this method is a Kernel. Another thing you might notice is that this method accepts a <code>uchar4</code> parameter and returns another <code>uchar4</code> value. <code>uchar4</code> is - like the <code>float3</code> variable we discussed in the chapter before - a vector. It contains 4 <code>uchar</code> values which are just byte values in the range from 0 to 255.</p><p>You can access these individual values in many different ways, for example <code>in.r</code> would return the byte which corresponds to the red channel of a pixel. We use a <code>uchar4</code> since each pixel is made up of 4 values - <code>r</code> for red, <code>g</code> for green, <code>b</code> for blue and <code>a</code> for alpha - and you can access them with this shorthand. RenderScript also allows you to take any number of values from a vector and create another vector with them. For example <code>in.rgb</code> would return a <code>uchar3</code> value which just contains the red, green and blue parts of the pixel without the alpha value.</p><p>At runtime RenderScript will call this Kernel method for each pixel of an image which is why the return value and parameter are just one <code>uchar4</code> value. RenderScript will run many of these calls in parallel on all available processors which is why RenderScript is so powerful. This also means that you don’t have to worry about threading or thread safety, you can just implement whatever you want to do to each pixel and RenderScript takes care of the rest.</p><p>When calling a Kernel in Java you supply two <code>Allocation</code> variables, one which contains the input data and another one which will receive the output. Your Kernel method will be called for each value in the input <code>Allocation</code> and will write the result to the output <code>Allocation</code>.</p><h2 id="25a43f9a-853d-4ba2-a8d5-adade51b1fd0" class="">RenderScript Runtime API methods<a class="header-anchor" href="#25a43f9a-853d-4ba2-a8d5-adade51b1fd0" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>In the Kernel above a few methods are used which are provided out of the box. RenderScript provides many such methods and they are vital for almost anything you are going to do with RenderScript. Among them are methods to do math operations like <code>sin()</code> and helper methods like <code>mix()</code> which mixes two values according to another values. But there are also methods for more complex operations when dealing with vectors, quaternions and matrices.</p><p>The official <a href="https://developer.android.com/guide/topics/renderscript/reference/overview.html"><strong>RenderScript Runtime API Reference</strong></a> is the best resource out there if you want to know more about a particular method or are looking for a specific method which performs a common operation like calculating the dot product of a matrix. You can find this documentation <a href="https://developer.android.com/guide/topics/renderscript/reference/overview.html"><strong>here</strong></a>.</p><h2 id="4f121b4f-d7c1-4cd1-958c-300c57b215d8" class="">Kernel Implementation<a class="header-anchor" href="#4f121b4f-d7c1-4cd1-958c-300c57b215d8" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>Now let’s take a look at the specifics of what this Kernel is doing. Here’s the first line in the Kernel:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">float4 f4 = rsUnpackColor8888(in);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>The first line calls the built in method <a href="https://developer.android.com/guide/topics/renderscript/reference/rs_convert.html#android_rs:rsUnpackColor8888"><code><strong>rsUnpackColor8888()</strong></code></a> which transforms the <code>uchar4</code> value to a <code>float4</code> values. Each color channel is also transformed to the range <code>0.0f - 1.0f</code> where <code>0.0f</code> corresponds to a byte value of <code>0</code> and <code>1.0f</code> to <code>255</code>. The main purpose of this is to make all the math in this Kernel a lot simpler.</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">float3 dotVector = dot(f4.rgb, gMonoMult);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>This next line uses the built in method <a href="https://developer.android.com/guide/topics/renderscript/reference/rs_vector_math.html#android_rs:dot"><code><strong>dot()</strong></code></a> to calculate the dot product of two vectors. <code>gMonoMult</code> is a constant value we defined a few chapters above. Since both vectors need to be of the same length to calculate the dot product and also since we just want to affect the color channels and not the alpha channel of a pixel we use the shorthand <code>.rgb</code> to get a new <code>float3</code> vector which just contains the red, green and blue color channels. Those of us who still remember from school how the dot product works will quickly notice that the dot product should return just one value and not a vector. Yet in the code above we are assigning the result to a <code>float3</code> vector. This is again a feature of RenderScript. When you assign a one dimensional number to a vector all elements in the vector will be set to this value. For example the following snippet will assign <code>2.0f</code> to each of the three values in the <code>float3</code> vector:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">float3 example = 2.0f;</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>So the result of the dot product above is assigned to each element in the <code>float3</code> vector above.</p><p>Now comes the part in which we actually use the global variable <code>saturationLevel</code> to modify the saturation of the image:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">float3 newColor = mix(dotVector, f4.rgb, saturationLevel);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>This uses the built in method <a href="https://developer.android.com/guide/topics/renderscript/reference/rs_math.html#android_rs:mix"><code><strong>mix()</strong></code></a> to mix together the original color with the dot product vector we created above. How they are mixed together is determined by the global <code>saturationLevel</code> variable. So a <code>saturationLevel</code> of <code>0.0f</code> will cause the resulting color to have no part of the original color values and will only consist of values in the <code>dotVector</code> which results in a black and white or grayed out image. A value of <code>1.0f</code> will cause the resulting color to be completely made up of the original color values and values above <code>1.0f</code> will multiply the original colors to make them more bright and intense.</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">return rsPackColorTo8888(newColor);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>This is the last part in the Kernel. <a href="https://developer.android.com/guide/topics/renderscript/reference/rs_convert.html#android_rs:rsPackColorTo8888"><code><strong>rsPackColorTo8888()</strong></code></a> transforms the <code>float3</code> vector back to a <code>uchar4</code> value which is then returned. The resulting byte values are clamped to a range between 0 and 255, so float values higher than <code>1.0f</code> will result in a byte value of 255 and values lower than <code>0.0</code> will result in a byte value of <code>0</code>.</p><p>And that is the whole Kernel implementation. Now there is only one part remaining: How to call a Kernel in Java.</p><h1 id="acdbd066-768d-496d-9b76-53fc0356492b" class="">Calling RenderScript in Java<a class="header-anchor" href="#acdbd066-768d-496d-9b76-53fc0356492b" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h1><h2 id="7dd92514-6019-4ce5-a1a6-42aa7d0a5b7e" class="">Basics<a class="header-anchor" href="#7dd92514-6019-4ce5-a1a6-42aa7d0a5b7e" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>As was already mentioned above for each RenderScript file a Java class is generated which allows you to interact with the your scripts. These files have the prefix <code>ScriptC_</code> followed by the name of the RenderScript file. To create an instance of these classes you first need an instance of the <code>RenderScript</code> class:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">final RenderScript renderScript = RenderScript.create(context);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>The static method <code>create()</code> can be used to create a <code>RenderScript</code> instance from a <code>Context</code>. You can then instantiate the Java class which was generated for your script. If you called the RenderScript file <code>saturation.rs</code> then the class will be called <code>ScriptC_saturation</code>:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">final ScriptC_saturation script = new ScriptC_saturation(renderScript);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>On this class you can now set the saturation level and call the Kernel. The setter which was generated for the <code>saturationLevel</code> variable will have the prefix <code>set_</code> followed by the name of the variable:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">script.set_saturationLevel(1.0f);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>There is also a getter prefixed with <code>get_</code> which allows you to get the saturation level currently set:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">float saturationLevel = script.get_saturationLevel();</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>Kernels you define in your RenderScript are prefixed with <code>forEach_</code> followed by the name of the Kernel method. The Kernel we have written expects an input <code>Allocation</code> and an output <code>Allocation</code> as its parameters:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">script.forEach_saturation(inputAllocation, outputAllocation);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>The input <code>Allocation</code> needs to contain the input image, and after the <code>forEach_saturation</code> method has finished the output allocation will contain the modified image data.</p><p>Once you have an <code>Allocation</code> instance you can copy data from and to those <code>Allocations</code> by using the methods <code>copyFrom()</code> and <code>copyTo()</code>. For example you can copy a new image into your input `Allocation by calling:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">inputAllocation.copyFrom(inputBitmap);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>The same way you can retrieve the result image by calling <code>copyTo()</code> on the output <code>Allocation</code>:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">outputAllocation.copyTo(outputBitmap);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><h2 id="69d10b00-ccc2-412c-8874-1c768d42d6dc" class="">Creating Allocation instances<a class="header-anchor" href="#69d10b00-ccc2-412c-8874-1c768d42d6dc" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>There are many ways to create an <code>Allocation</code>. Once you have an <code>Allocation</code> instance you can copy new data from and to those <code>Allocations</code> with <code>copyTo()</code> and <code>copyFrom()</code> like explained above, but to create them initially you have to know with what kind of data you are exactly working with. Let’s start with the input <code>Allocation</code>:</p><p>We can use the static method <code>createFromBitmap()</code> to quickly create our input <code>Allocation</code> from a <code>Bitmap</code>:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">final Allocation inputAllocation = Allocation.createFromBitmap(renderScript, image);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>In this example the input image never changes so we never need to modify the input <code>Allocation</code> again. We can reuse it each time the <code>saturationLevel</code> changes to create a new output <code>Bitmap</code>.</p><p>Creating the output <code>Allocation</code> is a little more complex. First we need to create what’s called a <code>Type</code>. A <code>Type</code> is used to tell an <code>Allocation</code> with what kind of data it’s dealing with. Usually one uses the <code>Type.Builder</code> class to quickly create an appropriate <code>Type</code>. Let’s take a look at the code first:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">final Type outputType = new Type.Builder(renderScript, Element.RGBA_8888(renderScript))
        .setX(inputBitmap.getWidth())
        .setY(inputBitmap.getHeight())
        .create();</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>We are working with a normal 32 bit (or in other words 4 byte) per pixel <code>Bitmap</code> with 4 color channels. That’s why we are choosing <code>Element.RGBA_8888</code> to create the <code>Type</code>. Then we use the methods <code>setX()</code> and <code>setY()</code> to set the width and height of the output image to the same size as the input image. The method <code>create()</code> then creates the <code>Type</code> with the parameters we specified.</p><p>Once we have the correct <code>Type</code> we can create the output <code>Allocation</code> with the static method <code>createTyped()</code>:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">final Allocation outputAllocation = Allocation.createTyped(renderScript, outputType);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>Now we are almost done. We also need an output <code>Bitmap</code> in which we can copy the data from the output <code>Allocation</code>. To do this we use the static method <code>createBitmap()</code> to create a new empty <code>Bitmap</code> with the same size and configuration as the input <code>Bitmap</code>.</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">final Bitmap outputBitmap = Bitmap.createBitmap(
        inputBitmap.getWidth(),
        inputBitmap.getHeight(),
        inputBitmap.getConfig()
);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>And with that we have all the puzzle pieces to execute our RenderScript.</p><h2 id="bec5ca28-2ea0-47ea-9849-e29677dce3b6" class="">Full example<a class="header-anchor" href="#bec5ca28-2ea0-47ea-9849-e29677dce3b6" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>Now let’s put all this together in one example:</p>
<div class="code-box lang-Plain Text">
	<div>
	<pre class="chroma">// Create the RenderScript instance
final RenderScript renderScript = RenderScript.create(context);

// Create the input Allocation 
final Allocation inputAllocation = Allocation.createFromBitmap(renderScript, inputBitmap);

// Create the output Type.
final Type outputType = new Type.Builder(renderScript, Element.RGBA_8888(renderScript))
        .setX(inputBitmap.getWidth())
        .setY(inputBitmap.getHeight())
        .create();

// And use the Type to create am output Allocation
final Allocation outputAllocation = Allocation.createTyped(renderScript, outputType);

// Create an empty output Bitmap from the input Bitmap
final Bitmap outputBitmap = Bitmap.createBitmap(
        inputBitmap.getWidth(),
        inputBitmap.getHeight(),
        inputBitmap.getConfig()
);

// Create an instance of our script
final ScriptC_saturation script = new ScriptC_saturation(renderScript);

// Set the saturation level
script.set_saturationLevel(2.0f);

// Execute the Kernel
script.forEach_saturation(inputAllocation, outputAllocation);

// Copy the result data to the output Bitmap
outputAllocation.copyTo(outputBitmap);

// Display the result Bitmap somewhere
someImageView.setImageBitmap(outputBitmap);</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><h1 id="ed3ad1f0-5462-49a1-bbb6-4944b420fb70" class="">Conclusion<a class="header-anchor" href="#ed3ad1f0-5462-49a1-bbb6-4944b420fb70" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h1><p>With this introduction you should be all set to write your own RenderScript Kernels for simple image manipulation. However there are a few things you have to keep in mind:</p><ul id="9ec100c1-51b1-46ec-855c-d81dd37ec9b3" class="bulleted-list"><li><strong>RenderScript only works in Application projects</strong>: Currently RenderScript files cannot be part of a library project.</li><li><strong>Watch out for memory</strong>: RenderScript is very fast, but it can also be memory intensive. There should never be more than one instance of <code>RenderScript</code> at any time. You should also reuse as much as possible. Normally you just need to create your <code>Allocation</code> instances once and can reuse them in the future. The same goes for output <code>Bitmaps</code> or your script instances. Reuse as much as possible.</li><li><strong>Do your work in the background</strong>: Again RenderScript is very fast, but not instant in any way. Any Kernel, especially complex ones should be executed off the UI thread in an <code>AsyncTask</code> or something similar. However for the most part you don’t have to worry about memory leaks. All RenderScript related classes only use the application <code>Context</code> and therefore don’t cause memory leaks. But you still have to worry about the usual stuff like leaking <code>View</code>, <code>Activity</code> or any <code>Context</code> instance which you use yourself!</li><li><strong>Use built in stuff</strong>: There are many predefined scripts which perform tasks like image blurring, blending, converting, resizing. And there are many more built in methods which help you implement your kernels. Chances are that if you want to do something there is either a script or method which already does what you are trying to do. Don’t reinvent the wheel.</li></ul><p>If you want to quickly get started and play around with actual code I recommend you take a look at the example GitHub project which implements the exact example talked about in this tutorial. You can find the project <a href="https://github.com/Wrdlbrnft/RenderScriptSample"><strong>here</strong></a>. Have fun with RenderScript!</p>

      <div class="forum-link">
  Found a mistake? Have a question or improvement idea?
  <a href="#" onclick="showContact(); return false;">Let me know</a>.
</div>

      <form id="contact-form" action="https://formsubmit.co/kkowalczyk@gmail.com" method="POST">
  <p>
    <div class="contact-light">Feedback about page:</div>
    <input type="text" name="page-url" id="contact-page-url" readonly />
  </p>

  <p>
    <div class="contact-light">Feedback:</div>
    <textarea name="message" id="msg-for-chris"></textarea>
    <div class="contact-light">Optional: your email if you want me to get back to you: </div>
    <input type="email" name="email" />
    <input type="text" name="_honey" style="display:none">
  </p>

  <p>
    <button type="submit" class="contact-btn">
      Send Feedback
    </button>

    <button class="contact-btn" style="float: right;" onclick="hideContact(); return false;">
      Cancel
    </button>
  </p>

  <p>
    <div data-netlify-recaptcha></div>
  </p>
</form>


      <hr class="article-bottom-sep">
    </div>

    <div id="page-toc"></div>

    <div id="chapter-toc-wrapper">
      <hr />
      <div class="hdr">Table Of Contents</div>
      <div id="book-toc"></div>
    </div>
  </div>

  <footer class="page__footer">
  <div class="page__footer__left">
    Maintained by
    <a href="https://blog.kowalczyk.info" target="_blank">Krzysztof Kowalczyk</a>
  </div>
  <div class="share-me">
    <a href="https://twitter.com/intent/tweet?text=%22Essential%20Android%22%20-%20a%20free%20programming%20book&url=%2fessential%2fandroid%2f&via=kjk">Share
      <b>Essential Android</b> on&nbsp;
      <svg class="icon-twitter">
        <use xlink:href="#icon-twitter"></use>
      </svg>
    </a>
  </div>
  <div class="page__footer__right">
    
  </div>
</footer>

  

</body>

</html>