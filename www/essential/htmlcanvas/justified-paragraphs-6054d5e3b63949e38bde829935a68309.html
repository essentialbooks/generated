<!doctype html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="referrer" content="always">

  <meta name="twitter:card" value="summary">
  <meta name="twitter:site" content="@kjk">
  <meta name="twitter:title" content="Justified paragraphs">
  
  <meta name="twitter:description" content="Justified paragraphs">
  <meta name="twitter:creator" content="@kjk">
  <meta name="twitter:image" content="/essential/htmlcanvas/covers/twitter/HTMLCanvas.png">
  
  <meta property="og:title" content="Justified paragraphs">
  <meta property="og:type" content="article" />
  <meta property="og:url" content="/essential/htmlcanvas/justified-paragraphs-6054d5e3b63949e38bde829935a68309" />
  
  <meta property="og:description" content="Justified paragraphs">
  <meta property="og:image" content="/essential/htmlcanvas/covers/twitter/HTMLCanvas.png">

  <title>Text / Justified paragraphs / Essential HTML5 Canvas</title>
  <meta name="description" content="Text / Justified paragraphs / Essential HTML5 Canvas">

  <link rel="icon" href="s/favicon-9dfe2f70.ico">

  <link href="s/main-e8ec5816.css" rel="stylesheet">
  <link href="s/bundle-83cf4538.css" rel="stylesheet">

  
  <script src="s/app-htmlcanvas-4af35db6.js" defer></script>
  <script src="s/bundle-fd6a7ad6.js" defer></script>
</head>

<body class="page">
  <script>
  function onLoad() {
    gBookTitle = "Essential HTML5 Canvas";

    httpsMaybeRedirect();

    let opts = {
      target: document.getElementById("toc"),
      props: {
        parentIdx: -1,
        level: 0,
      },
    };
    new app.toc(opts);

    opts = {
      target: document.getElementById("search-parent"),
      props: {
        bookTitle: gBookTitle,
      },
    };
    new app.searchInput(opts);

    opts = {
      target: document.getElementById("page-toc"),
    };
    new app.pageToc(opts);

    opts = {
      target: document.getElementById("book-toc"),
    };
    new app.bookToc(opts);
  }
  document.addEventListener('DOMContentLoaded', onLoad);
</script>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
  <symbol id="arrow-expanded" viewbox="0 0 16 16">
    <path fill="%23646465" d="M11 10H5.344L11 4.414V10z" />
  </symbol>

  <symbol id="arrow-not-expanded" viewbox="0 0 16 16">
    <path fill="%23646465" d="M6 4v8l4-4-4-4zm1 2.414L8.586 8 7 9.586V6.414z" />
  </symbol>

  <symbol id="icon-github" viewbox="0 0 496 512">
    <path
      d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" />
  </symbol>

  <symbol id="icon-home" viewbox="0 0 576 512">
    <path
      d="M488 312.7V456c0 13.3-10.7 24-24 24H348c-6.6 0-12-5.4-12-12V356c0-6.6-5.4-12-12-12h-72c-6.6 0-12 5.4-12 12v112c0 6.6-5.4 12-12 12H112c-13.3 0-24-10.7-24-24V312.7c0-3.6 1.6-7 4.4-9.3l188-154.8c4.4-3.6 10.8-3.6 15.3 0l188 154.8c2.7 2.3 4.3 5.7 4.3 9.3zm83.6-60.9L488 182.9V44.4c0-6.6-5.4-12-12-12h-56c-6.6 0-12 5.4-12 12V117l-89.5-73.7c-17.7-14.6-43.3-14.6-61 0L4.4 251.8c-5.1 4.2-5.8 11.8-1.6 16.9l25.5 31c4.2 5.1 11.8 5.8 16.9 1.6l235.2-193.7c4.4-3.6 10.8-3.6 15.3 0l235.2 193.7c5.1 4.2 12.7 3.5 16.9-1.6l25.5-31c4.2-5.2 3.4-12.7-1.7-16.9z" />
  </symbol>

  <symbol id="icon-twitter" viewbox="0 0 512 512">
    <path
      d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" />
  </symbol>

  <symbol id="icon-edit" viewbox="0 0 576 512">
    <path
      d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z" />
  </symbol>

  <symbol id="icon-star" viewbox="0 0 576 512">
    <path
      d="M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z" />
  </symbol>
</svg>
  <header class="page__header">
  <div class="page__header__left">
    <a id="link-home" href="index.html">
      <svg class="icon-home">
        <use xlink:href="#icon-home"></use>
      </svg>
      &nbsp;Essential HTML5 Canvas</a>
  </div>
  <div class="page__header__center" id="search-parent">
  </div>
  <div class="page__header__right">
  </div>
</header>

  <div id="toc"></div>

  <div class="content">
    <div class="article">
      

<div style="display: flex; justify-content: space-between">
  <h1 class="title">Justified paragraphs</h1>
  <a class="edit-link" style="font-size: 80%" href="https://notion.so/6054d5e3b63949e38bde829935a68309" rel="nofollow"
  target="_blank">suggest change</a>
</div>


      <p>Renders text as justified paragraphs. <strong>REQUIRES</strong> the example <strong>Justified text</strong></p><h2 id="6aff6237-f78c-4a66-8243-3f50aad3d2ae" class="">Example render<a class="header-anchor" href="#6aff6237-f78c-4a66-8243-3f50aad3d2ae" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>Top paragraph has setting.compact = true and bottom false and line spacing is 1.2 rather than the default 1.5. Rendered by code usage example bottom of this example.</p><img class="img" src="/img/480834a88c0895050be224c40250835f7dcb2108.png"><hr id="32069a1f-877f-4bae-b895-3175f74d2909"/><h2 id="ea4f2b02-6043-4080-a68e-93604d11c62b" class="">Example code<a class="header-anchor" href="#ea4f2b02-6043-4080-a68e-93604d11c62b" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2>
<div class="code-box lang-JavaScript">
	<div>
	<pre class="chroma"><span class="c1">// Requires justified text extensions 
</span><span class="c1"></span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
   <span class="c1">// code point A
</span><span class="c1"></span>   <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">CanvasRenderingContext2D</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">fillJustifyText</span> <span class="o">!==</span> <span class="s2">&#34;function&#34;</span><span class="p">){</span>
       <span class="k">throw</span> <span class="k">new</span> <span class="nx">ReferenceError</span><span class="p">(</span><span class="s2">&#34;Justified Paragraph extension missing requiered CanvasRenderingContext2D justified text extension&#34;</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="kd">var</span> <span class="nx">maxSpaceSize</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="c1">// Multiplier for max space size. If greater then no justificatoin applied
</span><span class="c1"></span>   <span class="kd">var</span> <span class="nx">minSpaceSize</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="c1">// Multiplier for minimum space size   
</span><span class="c1"></span>   <span class="kd">var</span> <span class="nx">compact</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// if true then try and fit as many words as possible. If false then try to get the spacing as close as possible to normal
</span><span class="c1"></span>   <span class="kd">var</span> <span class="nx">lineSpacing</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span> <span class="c1">// space between lines
</span><span class="c1"></span>   <span class="kr">const</span> <span class="nx">noJustifySetting</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1">// This setting forces justified text off. Used to render last line of paragraph.
</span><span class="c1"></span>       <span class="nx">minSpaceSize</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
       <span class="nx">maxSpaceSize</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="p">}</span>

   <span class="c1">// Parse vet and set settings object.
</span><span class="c1"></span>   <span class="kd">var</span> <span class="nx">justifiedTextSettings</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">settings</span><span class="p">){</span>
       <span class="kd">var</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">vetNumber</span> <span class="o">=</span> <span class="p">(</span><span class="nx">num</span><span class="p">,</span> <span class="nx">defaultNum</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
           <span class="nx">num</span> <span class="o">=</span> <span class="nx">num</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">num</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="o">?</span> <span class="nx">num</span> <span class="o">:</span> <span class="nx">defaultNum</span><span class="p">;</span>
           <span class="k">return</span> <span class="nx">num</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">defaultNum</span> <span class="o">:</span> <span class="nx">num</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">if</span><span class="p">(</span><span class="nx">settings</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">settings</span> <span class="o">===</span> <span class="kc">null</span><span class="p">){</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
       <span class="nx">compact</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">compact</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">compact</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="nx">compact</span><span class="p">;</span>
       <span class="nx">max</span> <span class="o">=</span> <span class="nx">vetNumber</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">maxSpaceSize</span><span class="p">,</span> <span class="nx">maxSpaceSize</span><span class="p">);</span>
       <span class="nx">min</span> <span class="o">=</span> <span class="nx">vetNumber</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">minSpaceSize</span><span class="p">,</span> <span class="nx">minSpaceSize</span><span class="p">);</span>
       <span class="nx">lineSpacing</span> <span class="o">=</span> <span class="nx">vetNumber</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">lineSpacing</span><span class="p">,</span> <span class="nx">lineSpacing</span><span class="p">);</span>
       <span class="k">if</span><span class="p">(</span><span class="nx">min</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="p">){</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
       <span class="nx">minSpaceSize</span> <span class="o">=</span> <span class="nx">min</span><span class="p">;</span>
       <span class="nx">maxSpaceSize</span> <span class="o">=</span> <span class="nx">max</span><span class="p">;</span>
   <span class="p">}</span>        
   <span class="kd">var</span> <span class="nx">getFontSize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">font</span><span class="p">){</span>  <span class="c1">// get the font size. 
</span><span class="c1"></span>       <span class="kd">var</span> <span class="nx">numFind</span> <span class="o">=</span> <span class="sr">/[0-9]+/</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">number</span> <span class="o">=</span> <span class="nx">numFind</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">font</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
       <span class="k">if</span><span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">number</span><span class="p">)){</span>
           <span class="k">throw</span> <span class="k">new</span> <span class="nx">ReferenceError</span><span class="p">(</span><span class="s2">&#34;justifiedPar Cant find font size&#34;</span><span class="p">);</span>
       <span class="p">}</span>
       <span class="k">return</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">number</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="kd">function</span> <span class="nx">justifiedPar</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">stroke</span><span class="p">){</span>
       <span class="kd">var</span> <span class="nx">spaceWidth</span><span class="p">,</span> <span class="nx">minS</span><span class="p">,</span> <span class="nx">maxS</span><span class="p">,</span> <span class="nx">words</span><span class="p">,</span> <span class="nx">count</span><span class="p">,</span> <span class="nx">lines</span><span class="p">,</span> <span class="nx">lineWidth</span><span class="p">,</span> <span class="nx">lastLineWidth</span><span class="p">,</span> <span class="nx">lastSize</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">renderer</span><span class="p">,</span> <span class="nx">fontSize</span><span class="p">,</span> <span class="nx">adjSpace</span><span class="p">,</span> <span class="nx">spaces</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">lineWords</span><span class="p">,</span> <span class="nx">lineFound</span><span class="p">;</span>
       <span class="nx">spaceWidth</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">measureText</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">).</span><span class="nx">width</span><span class="p">;</span>
       <span class="nx">minS</span> <span class="o">=</span> <span class="nx">spaceWidth</span> <span class="o">*</span> <span class="nx">minSpaceSize</span><span class="p">;</span>
       <span class="nx">maxS</span> <span class="o">=</span> <span class="nx">spaceWidth</span> <span class="o">*</span> <span class="nx">maxSpaceSize</span><span class="p">;</span>
       <span class="nx">words</span> <span class="o">=</span> <span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">word</span> <span class="p">=&gt;</span> <span class="p">{</span>  <span class="c1">// measure all words.
</span><span class="c1"></span>           <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">measureText</span><span class="p">(</span><span class="nx">word</span><span class="p">).</span><span class="nx">width</span><span class="p">;</span>                
           <span class="k">return</span> <span class="p">{</span>
               <span class="nx">width</span> <span class="o">:</span> <span class="nx">w</span><span class="p">,</span>
               <span class="nx">word</span> <span class="o">:</span> <span class="nx">word</span><span class="p">,</span>
           <span class="p">};</span>
       <span class="p">});</span>
       <span class="c1">// count = num words, spaces = number spaces, spaceWidth normal space size
</span><span class="c1"></span>       <span class="c1">// adjSpace new space size &gt;= min size. useSize Resulting space size used to render
</span><span class="c1"></span>       <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="nx">lines</span> <span class="o">=</span> <span class="p">[];</span>
       <span class="c1">// create lines by shifting words from the words array until the spacing is optimal. If compact
</span><span class="c1"></span>       <span class="c1">// true then will true and fit as many words as possible. Else it will try and get the spacing as
</span><span class="c1"></span>       <span class="c1">// close as possible to the normal spacing
</span><span class="c1"></span>       <span class="k">while</span><span class="p">(</span><span class="nx">words</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
           <span class="nx">lastLineWidth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
           <span class="nx">lastSize</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
           <span class="nx">lineFound</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
           <span class="c1">// each line must have at least one word.
</span><span class="c1"></span>           <span class="nx">word</span> <span class="o">=</span> <span class="nx">words</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
           <span class="nx">lineWidth</span> <span class="o">=</span> <span class="nx">word</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
           <span class="nx">lineWords</span> <span class="o">=</span> <span class="p">[</span><span class="nx">word</span><span class="p">.</span><span class="nx">word</span><span class="p">];</span>
           <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
           <span class="k">while</span><span class="p">(</span><span class="nx">lineWidth</span> <span class="o">&lt;</span> <span class="nx">width</span> <span class="o">&amp;&amp;</span> <span class="nx">words</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span> <span class="c1">// Add words to line
</span><span class="c1"></span>               <span class="nx">word</span> <span class="o">=</span> <span class="nx">words</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
               <span class="nx">lineWidth</span> <span class="o">+=</span> <span class="nx">word</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
               <span class="nx">lineWords</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">word</span><span class="p">.</span><span class="nx">word</span><span class="p">);</span>
               <span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="nx">spaces</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
               <span class="nx">adjSpace</span> <span class="o">=</span>  <span class="p">(</span><span class="nx">width</span> <span class="o">-</span> <span class="nx">lineWidth</span><span class="p">)</span> <span class="o">/</span> <span class="nx">spaces</span><span class="p">;</span>
               <span class="k">if</span><span class="p">(</span><span class="nx">minS</span> <span class="o">&gt;</span> <span class="nx">adjSpace</span><span class="p">){</span>  <span class="c1">// if spacing less than min remove last word and finish line
</span><span class="c1"></span>                   <span class="nx">lineFound</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                   <span class="nx">words</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">word</span><span class="p">);</span>
                   <span class="nx">lineWords</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
               <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">compact</span><span class="p">){</span> <span class="c1">// if compact mode 
</span><span class="c1"></span>                       <span class="k">if</span><span class="p">(</span><span class="nx">adjSpace</span> <span class="o">&lt;</span> <span class="nx">spaceWidth</span><span class="p">){</span> <span class="c1">// if less than normal space width
</span><span class="c1"></span>                           <span class="k">if</span><span class="p">(</span><span class="nx">lastSize</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                               <span class="nx">lastSize</span> <span class="o">=</span> <span class="nx">adjSpace</span><span class="p">;</span>
                           <span class="p">}</span>
                           <span class="c1">// check if with last word on if its closer to space width
</span><span class="c1"></span>                           <span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">spaceWidth</span> <span class="o">-</span> <span class="nx">adjSpace</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">spaceWidth</span> <span class="o">-</span> <span class="nx">lastSize</span><span class="p">)){</span>
                               <span class="nx">lineFound</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// yes keep it
</span><span class="c1"></span>                           <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                               <span class="nx">words</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">word</span><span class="p">);</span>  <span class="c1">// no better fit if last word removes
</span><span class="c1"></span>                               <span class="nx">lineWords</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
                               <span class="nx">lineFound</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                           <span class="p">}</span>
                       <span class="p">}</span>
                   <span class="p">}</span>
               <span class="p">}</span>
               <span class="nx">lastSize</span> <span class="o">=</span> <span class="nx">adjSpace</span><span class="p">;</span> <span class="c1">// remember spacing 
</span><span class="c1"></span>           <span class="p">}</span>
           <span class="nx">lines</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">lineWords</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">));</span> <span class="c1">// and the line
</span><span class="c1"></span>       <span class="p">}</span>
       <span class="c1">// lines have been worked out get font size, render, and render all the lines. last
</span><span class="c1"></span>       <span class="c1">// line may need to be rendered as normal so it is outside the loop.
</span><span class="c1"></span>       <span class="nx">fontSize</span> <span class="o">=</span> <span class="nx">getFontSize</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">font</span><span class="p">);</span>
       <span class="nx">renderer</span> <span class="o">=</span> <span class="nx">stroke</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">?</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeJustifyText</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="o">:</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillJustifyText</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
       <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">++</span><span class="p">){</span>
           <span class="nx">renderer</span><span class="p">(</span><span class="nx">lines</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
           <span class="nx">y</span> <span class="o">+=</span> <span class="nx">lineSpacing</span> <span class="o">*</span> <span class="nx">fontSize</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">if</span><span class="p">(</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span> <span class="c1">// last line if left or start aligned for no justify
</span><span class="c1"></span>           <span class="k">if</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">===</span> <span class="s2">&#34;left&#34;</span> <span class="o">||</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">===</span> <span class="s2">&#34;start&#34;</span><span class="p">){</span>
               <span class="nx">renderer</span><span class="p">(</span><span class="nx">lines</span><span class="p">[</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">noJustifySetting</span><span class="p">);</span>
               <span class="nx">ctx</span><span class="p">.</span><span class="nx">measureJustifiedText</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
           <span class="p">}</span><span class="k">else</span><span class="p">{</span>
               <span class="nx">renderer</span><span class="p">(</span><span class="nx">lines</span><span class="p">[</span><span class="nx">lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">);</span>
           <span class="p">}</span>
       <span class="p">}</span>
       <span class="c1">// return details about the paragraph.
</span><span class="c1"></span>       <span class="nx">y</span> <span class="o">+=</span> <span class="nx">lineSpacing</span> <span class="o">*</span> <span class="nx">fontSize</span><span class="p">;</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">nextLine</span> <span class="o">:</span> <span class="nx">y</span><span class="p">,</span>
           <span class="nx">fontSize</span> <span class="o">:</span> <span class="nx">fontSize</span><span class="p">,</span>
           <span class="nx">lineHeight</span> <span class="o">:</span> <span class="nx">lineSpacing</span> <span class="o">*</span> <span class="nx">fontSize</span><span class="p">,</span>
       <span class="p">};</span>
   <span class="p">}</span>
   <span class="c1">// define fill
</span><span class="c1"></span>   <span class="kd">var</span> <span class="nx">fillParagraphText</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">){</span>
       <span class="nx">justifiedTextSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>
       <span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span>
           <span class="nx">minSpaceSize</span> <span class="o">:</span> <span class="nx">minSpaceSize</span><span class="p">,</span>
           <span class="nx">maxSpaceSize</span> <span class="o">:</span> <span class="nx">maxSpaceSize</span><span class="p">,</span>
       <span class="p">};</span>
       <span class="k">return</span> <span class="nx">justifiedPar</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="c1">// define stroke
</span><span class="c1"></span>   <span class="kd">var</span> <span class="nx">strokeParagraphText</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">){</span>
       <span class="nx">justifiedTextSettings</span><span class="p">(</span><span class="nx">settings</span><span class="p">);</span>
       <span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span>
           <span class="nx">minSpaceSize</span> <span class="o">:</span> <span class="nx">minSpaceSize</span><span class="p">,</span>
           <span class="nx">maxSpaceSize</span> <span class="o">:</span> <span class="nx">maxSpaceSize</span><span class="p">,</span>
       <span class="p">};</span>
       <span class="k">return</span> <span class="nx">justifiedPar</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="nx">CanvasRenderingContext2D</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">fillParaText</span> <span class="o">=</span> <span class="nx">fillParagraphText</span><span class="p">;</span>
   <span class="nx">CanvasRenderingContext2D</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">strokeParaText</span> <span class="o">=</span> <span class="nx">strokeParagraphText</span><span class="p">;</span>
<span class="p">})();</span>
</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><blockquote id="85bbdf44-45ab-4ea0-b0ea-08564b2313ed" class="">NOTE this extends the CanvasRenderingContext2D prototype. If you do not wish this to happen use the example Justified text to work out how to change this example to be part of the global namespace.</blockquote><blockquote id="74deea58-90c8-4373-a932-b90d00555c5a" class="">NOTE Will throw a ReferenceError if this example can not find the function CanvasRenderingContext2D.prototype.fillJustifyText</blockquote><h2 id="d9b57f00-3b7d-4f55-95d3-ee916e82309c" class="">How to use<a class="header-anchor" href="#d9b57f00-3b7d-4f55-95d3-ee916e82309c" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2>
<div class="code-box lang-JavaScript">
	<div>
	<pre class="chroma"><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillParaText</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="p">[</span><span class="nx">settings</span><span class="p">]);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeParaText</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="p">[</span><span class="nx">settings</span><span class="p">]);</span>
</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><p>See <strong>Justified text</strong> for details on arguments. Arguments between <code>\[</code> and <code>\]</code> are optional.</p><p>The <code>settings</code> argument has two additional properties.</p><ul id="9237886f-2f46-4d36-b502-f8f1b7855c30" class="bulleted-list"><li><strong>compact:</strong> Default <code>true</code>. If true tries to pack as many words as possible per line. If false the tries to get the word spacing as close as possible to normal spacing.</li><li><strong>lineSpacing</strong> Default <code>1.5</code>. Space per line default <code>1.5</code> the distance from on line to the next in terms of font size</li></ul><p>Properties missing from the settings object will default to their default values or to the last valid values. The properties will only be changed if the new values are valid. For <code>compact</code> valid values are only booleans <code>true</code> or <code>false</code> Truthy values are not considered valid.</p><h2 id="5d7b2f83-597d-431c-b4f1-8928474542d7" class="">Return object<a class="header-anchor" href="#5d7b2f83-597d-431c-b4f1-8928474542d7" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2><p>The two functions return an object containing information to help you place the next paragraph. The object contains the following properties.</p><ul id="224351ee-f8e9-4065-8718-1620df238c69" class="bulleted-list"><li><strong>nextLine</strong> Position of the next line after the paragraph pixels.</li><li><strong>fontSize</strong> Size of the font. (please note only use fonts defined in pixels eg <code>14px arial</code>)</li><li><strong>lineHeight</strong> Distance in pixels from one line to the next</li></ul><p>This example uses a simple algorithm that works one line at to time to find the best fit for a paragraph. This does not mean that it the best fit (rather the algorithmâ€™s best) You may wish to improve the algorithm by creating a multi pass line algorithm over the generated lines. Moving words from the end of one line to the start of the next, or from the start back to the end. The best look is achieved when the spacing over the entire paragraph has the smallest variation and is the closest to the normal text spacing.</p><p>As this example is dependent on the <strong>Justified text</strong> example the code is very similar. You may wish to move the two into one function. Replace the function <code>justifiedTextSettings</code> in the other example with the one used in this example. Then copy all the rest of the code from this example into the anonymous function body of the <strong>Justified text</strong> example. You will no longer need to test for dependencies found at <code>// Code point A</code> It can be removed.</p><hr id="5f2f6a61-7627-4a7b-807a-b6d7d01cd02e"/><h2 id="9ae497c7-cb75-4a41-a19a-5fca42de4dc4" class="">Usage example<a class="header-anchor" href="#9ae497c7-cb75-4a41-a19a-5fca42de4dc4" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a></h2>
<div class="code-box lang-JavaScript">
	<div>
	<pre class="chroma"><span class="nx">ctx</span><span class="p">.</span><span class="nx">font</span> <span class="o">=</span> <span class="s2">&#34;25px arial&#34;</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">=</span> <span class="s2">&#34;center&#34;</span>

<span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">center</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="o">-</span><span class="nx">left</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="s2">&#34;Justified paragraph examples.&#34;</span><span class="p">,</span><span class="nx">center</span><span class="p">,</span><span class="nx">y</span><span class="p">);</span>
<span class="nx">y</span><span class="o">+=</span> <span class="mi">30</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">font</span> <span class="o">=</span> <span class="s2">&#34;14px arial&#34;</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">=</span> <span class="s2">&#34;left&#34;</span>
<span class="c1">// set para settings
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">setting</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">maxSpaceSize</span> <span class="o">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="nx">minSpaceSize</span> <span class="o">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="nx">lineSpacing</span> <span class="o">:</span> <span class="mf">1.2</span><span class="p">,</span>
    <span class="nx">compact</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
<span class="c1">// Show the left and right bounds.
</span><span class="c1"></span><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="s2">&#34;red&#34;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">size</span> <span class="o">*</span> <span class="mi">15</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">-</span> <span class="nx">left</span><span class="p">,</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">-</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">size</span> <span class="o">*</span> <span class="mi">15</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">=</span> <span class="s2">&#34;left&#34;</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">&#34;black&#34;</span><span class="p">;</span>

<span class="c1">// Draw paragraph
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillParaText</span><span class="p">(</span><span class="nx">para</span><span class="p">,</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">setting</span><span class="p">);</span>  <span class="c1">// settings is remembered    
</span><span class="c1"></span>
<span class="c1">// Next paragraph
</span><span class="c1"></span><span class="nx">y</span> <span class="o">=</span> <span class="nx">line</span><span class="p">.</span><span class="nx">nextLine</span> <span class="o">+</span> <span class="nx">line</span><span class="p">.</span><span class="nx">lineHeight</span><span class="p">;</span>
<span class="nx">setting</span><span class="p">.</span><span class="nx">compact</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillParaText</span><span class="p">(</span><span class="nx">para</span><span class="p">,</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">setting</span><span class="p">);</span>
</pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div><blockquote id="a8ec3872-627a-47ac-a0d3-dd313975717d" class="">Note: For text aligned left or start the last line of tha paragraph will always have normal spacing. For all other alignments the last line is treated like all others.</blockquote><blockquote id="b110caf8-86e0-499b-b14b-eee764fd3075" class="">Note: You can inset the start of the paragraph with spaces. Though this may not be consistent from paragraph to paragraph. It is always a good thing to learn what a function is doing and modifying it. An exercise would be to add a setting to the settings that indents the first line by a fixed amount. Hint the while loop will need to temporarily make the first word appear larger (+ indent) words[0].width += ? and then when rendering lines indent the first line.</blockquote>

      <div class="forum-link">
  Found a mistake? Have a question or improvement idea?
  <a href="#" onclick="showContact(); return false;">Let me know</a>.
</div>

      <form id="contact-form" action="https://formsubmit.co/kkowalczyk@gmail.com" method="POST">
  <p>
    <div class="contact-light">Feedback about page:</div>
    <input type="text" name="page-url" id="contact-page-url" readonly />
  </p>

  <p>
    <div class="contact-light">Feedback:</div>
    <textarea name="message" id="msg-for-chris"></textarea>
    <div class="contact-light">Optional: your email if you want me to get back to you: </div>
    <input type="email" name="email" />
    <input type="text" name="_honey" style="display:none">
  </p>

  <p>
    <button type="submit" class="contact-btn">
      Send Feedback
    </button>

    <button class="contact-btn" style="float: right;" onclick="hideContact(); return false;">
      Cancel
    </button>
  </p>

  <p>
    <div data-netlify-recaptcha></div>
  </p>
</form>


      <hr class="article-bottom-sep">
    </div>

    <div id="page-toc"></div>

    <div id="chapter-toc-wrapper">
      <hr />
      <div class="hdr">Table Of Contents</div>
      <div id="book-toc"></div>
    </div>
  </div>

  <footer class="page__footer">
  <div class="page__footer__left">
    Maintained by
    <a href="https://blog.kowalczyk.info" target="_blank">Krzysztof Kowalczyk</a>
  </div>
  <div class="share-me">
    <a href="https://twitter.com/intent/tweet?text=%22Essential%20HTML5%20Canvas%22%20-%20a%20free%20programming%20book&url=%2fessential%2fhtmlcanvas%2f&via=kjk">Share
      <b>Essential HTML5 Canvas</b> on&nbsp;
      <svg class="icon-twitter">
        <use xlink:href="#icon-twitter"></use>
      </svg>
    </a>
  </div>
  <div class="page__footer__right">
    
  </div>
</footer>

  

</body>

</html>